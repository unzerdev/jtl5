!function(){function e(t,n,r){function i(s,o){if(!n[s]){if(!t[s]){var u="function"==typeof require&&require;if(!o&&u)return u(s,!0);if(a)return a(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[s]={exports:{}};t[s][0].call(c.exports,function(e){return i(t[s][1][e]||e)},c,c.exports,e,t,n,r)}return n[s].exports}for(var a="function"==typeof require&&require,s=0;s<r.length;s++)i(r[s]);return i}return e}()({1:[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault"),i=r(e("./payments/applepay")),a=r(e("./payments/general")),s=r(e("./payments/instalment"));window.HpPayment=a.default,window.HpInstalment=s.default,window.UnzerApplePay=i.default},{"./payments/applepay":2,"./payments/general":3,"./payments/instalment":4,"@babel/runtime/helpers/interopRequireDefault":10}],2:[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=r(e("@babel/runtime/helpers/classCallCheck")),a=r(e("@babel/runtime/helpers/createClass")),s=r(e("../utils/errors")),o=r(e("../utils/debugging")),u={NOT_SUPPORTED:"This device does not support Apple Pay!",CANCEL_BY_USER:"Canceled payment process by user!"},l=function(){function e(t,n,r,a){(0,i.default)(this,e),this.settings=a||{},this.snippets=Object.assign(u,r);var l={locale:this.settings.locale||"de-DE"};this.applePayPaymentRequest=n,this.unzerInstance=new unzer(t,l),this.errorHandler=new s.default(this.settings.$errorContainer,this.settings.$errorMessage),this.debugging=new o.default($(".unzerUI")),window.UNZER_DEBUG=!!this.unzerInstance._isSandbox||this.unzerInstance.config.hasSandboxKey,window.ApplePaySession&&window.ApplePaySession.canMakePayments()?(this.form=this.settings.form||document.getElementById("form_payment_extra"),this.initPaymentType=this.initPaymentType.bind(this),this.form.addEventListener("submit",this.initPaymentType),$(".apple-pay-button").on("click",this.initPaymentType.bind(this))):this.unsupportedDevice()}return(0,a.default)(e,[{key:"initPaymentType",value:function(e){var t=this;if(e.preventDefault(),window.ApplePaySession&&window.ApplePaySession.canMakePayments()){var n=new ApplePaySession(3,this.applePayPaymentRequest);this.debugging.log("[> Init Payment Type]",{paymentRequest:this.applePayPaymentRequest}),n.onvalidatemerchant=function(e){t.merchantValidationCallback(e,n)},n.onpaymentauthorized=function(e){t.applePayAuthorizedCallback(e,n)},n.oncancel=function(e){t.debugging.log("[> Cancel]",{event:e}),t.errorHandler.show(t.snippets.CANCEL_BY_USER)},n.begin()}else this.unsupportedDevice()}},{key:"merchantValidationCallback",value:function(e,t){var n=this,r=JSON.stringify(e.validationURL);this.debugging.log("[> Merchant Validation]",{event:e}),$.ajax({url:$.evo.io().options.ioUrl,method:"POST",dataType:"json",data:'io={"name":"apple_pay_merchantvalidation", "params":['+r+"]}"}).done(function(e){n.debugging.log("[> Merchant Validation Response]",e);try{t.completeMerchantValidation(e)}catch(e){alert(e.message)}}).fail(function(e){n.debugging.log("[> Merchant Validation Error]",e),n.errorHandler.show(JSON.stringify(e.statusText)),t.abort()})}},{key:"applePayAuthorizedCallback",value:function(e,t){var n=this,r=this.unzerInstance.ApplePay(),i=e.payment.token.paymentData;this.debugging.log("[> Payment Authorization]",{unzerApplePayInstance:r,event:e,paymentData:i}),r.createResource(i).then(function(e){var r=JSON.stringify(e.id);$.ajax({url:$.evo.io().options.ioUrl,method:"POST",dataType:"json",data:'io={"name":"apple_pay_payment_authorized", "params":['+r+"]}"}).done(function(e){n.debugging.log("[> Payment Authorization Response]",{result:e,typeId:r});var i=e.transactionStatus;if("success"===i||"pending"===i){t.completePayment({status:window.ApplePaySession.STATUS_SUCCESS});var a=document.createElement("input");a.setAttribute("type","hidden"),a.setAttribute("name","paymentData[resourceId]"),a.setAttribute("value",r),n.form.appendChild(a),n.form.removeEventListener("submit",n.initPaymentType),n.form.submit()}else n.abortPaymentSession(t)}).fail(function(e){n.errorHandler.show(e.statusText),n.abortPaymentSession(t)})}).catch(function(e){n.debugging.log("[> Payment Authorization Error]",e),n.errorHandler.show(e.message),n.abortPaymentSession(t)})}},{key:"unsupportedDevice",value:function(){this.settings.submitButton.disabled=!0,this.settings.submitButton.ariaDisabled=!0,this.errorHandler.show(this.snippets.NOT_SUPPORTED)}},{key:"abortPaymentSession",value:function(e){this.debugging.log("[> Abort Payment Session]",{status:window.ApplePaySession.STATUS_FAILURE}),e.completePayment({status:window.ApplePaySession.STATUS_FAILURE}),e.abort()}}]),e}();n.default=l},{"../utils/debugging":5,"../utils/errors":6,"@babel/runtime/helpers/classCallCheck":7,"@babel/runtime/helpers/createClass":8,"@babel/runtime/helpers/interopRequireDefault":10}],3:[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=r(e("@babel/runtime/helpers/classCallCheck")),a=r(e("@babel/runtime/helpers/createClass")),s=r(e("@babel/runtime/helpers/defineProperty")),o=r(e("../utils/errors")),u=function(){function e(t,n,r){(0,i.default)(this,e),this.settings=r||{};var a={locale:this.settings.locale||"de-DE"};this.unzerInstance=new unzer(t,a),this.errorHandler=new o.default(this.settings.$errorContainer,this.settings.$errorMessage),this.customerId=r.customerId||null,this.customerResource=null,this.paymentType=this.initPaymentType(n),this.form=this.settings.form||document.getElementById("form_payment_extra"),this.handleFormSubmit=this.handleFormSubmit.bind(this),this.form.addEventListener("submit",this.handleFormSubmit),this.settings.autoSubmit&&this.handleFormSubmit(new Event("submit"))}return(0,a.default)(e,[{key:"initPaymentType",value:function(t){switch(t){case e.PAYMENT_TYPES.CARD:return this.createCard();case e.PAYMENT_TYPES.INVOICE:return this.createInvoice();case e.PAYMENT_TYPES.INVOICE_GUARANTEED:return this.createInvoiceGuaranteed();case e.PAYMENT_TYPES.INVOICE_FACTORING:return this.createInvoiceFactoring();case e.PAYMENT_TYPES.SEPA:return this.createSepa();case e.PAYMENT_TYPES.SEPA_GUARANTEED:return this.createSepaGuaranteed();case e.PAYMENT_TYPES.PAYPAL:return this.createPaypal();case e.PAYMENT_TYPES.SOFORT:return this.createSofort();case e.PAYMENT_TYPES.GIROPAY:return this.createGiropay();case e.PAYMENT_TYPES.PRZELEWY24:return this.createPrzelewy24();case e.PAYMENT_TYPES.IDEAL:return this.createIdeal();case e.PAYMENT_TYPES.PREPAYMENT:return this.createPrepayment();case e.PAYMENT_TYPES.EPS:return this.createEPS();case e.PAYMENT_TYPES.FLEXIPAY_DIRECT:return this.createFlexiPayDirect();case e.PAYMENT_TYPES.ALIPAY:return this.createAlipay();case e.PAYMENT_TYPES.WECHAT_PAY:return this.createWeChatPay();case e.PAYMENT_TYPES.HIRE_PURCHASE:return this.createHirePurchase();case e.PAYMENT_TYPES.PAYLATER_INVOICE:return this.createPaylaterInvoice();case e.PAYMENT_TYPES.BANCONTACT:return this.createBancontact();default:throw new Error("Unkown Payment Type: "+t)}}},{key:"handleFormSubmit",value:function(e){var t=this;e.preventDefault();var n=[this.paymentType.createResource()];this.customerResource&&n.push(this.customerId?this.customerResource.updateCustomer():this.customerResource.createCustomer()),Promise.all(n).then(function(e){var n=document.createElement("input");if(n.setAttribute("type","hidden"),n.setAttribute("name","paymentData[resourceId]"),n.setAttribute("value",e[0].id),t.form.appendChild(n),e.length>=2){var r=document.createElement("input");r.setAttribute("type","hidden"),r.setAttribute("name","paymentData[customerId]"),r.setAttribute("value",e[1].id),t.form.appendChild(r)}t.form.removeEventListener("submit",t.handleFormSubmit),t.form.submit()}).catch(function(e){t.errorHandler.show(e.message)})}},{key:"createCustomer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.settings.isB2B?this.unzerInstance.B2BCustomer():this.unzerInstance.Customer(),n=this.settings.customer||{},r=this.settings.submitButton||document.getElementById("submit-button"),i={containerId:"customer",showInfoBox:!1,showHeader:!1};return e&&(i.paymentTypeName=e),t.initFormFields(n),t.addEventListener("validate",function(e){e.success?r.removeAttribute("disabled"):r.setAttribute("disabled",!0)}),this.customerId?(i.fields=["name","birthdate"],t.update(this.customerId,i),t):(t.create(i),t)}},{key:"createPaylaterInvoice",value:function(){this.customerResource=this.createCustomer("paylater-invoice");var e=this.settings.submitButton||document.getElementById("submit-button"),t=this.unzerInstance.PaylaterInvoice();return t.create({containerId:"paylater-invoice",customerType:this.settings.isB2B?"B2B":"B2C"}),t.addEventListener("change",function(t){t.success?e.removeAttribute("disabled"):e.setAttribute("disabled",!0)}),t}},{key:"createBancontact",value:function(){var e=this.unzerInstance.Bancontact(),t={fontSize:null,fontColor:null,fontFamily:null};return this.settings.styling&&(t.fontColor=this.settings.styling.fontColor||null,t.fontSize=this.settings.styling.fontSize||null,t.fontFamily=this.settings.styling.fontFamily||null),e.create("holder",{containerId:"bancontact-holder",fontSize:t.fontSize,fontColor:t.fontColor,fontFamily:t.fontFamily}),e}},{key:"createCard",value:function(){var e=this.unzerInstance.Card(),t={fontSize:null,fontColor:null,fontFamily:null};this.settings.styling&&(t.fontColor=this.settings.styling.fontColor||null,t.fontSize=this.settings.styling.fontSize||null,t.fontFamily=this.settings.styling.fontFamily||null),e.create("number",{containerId:"card-element-id-number",onlyIframe:!1,fontSize:t.fontSize,fontColor:t.fontColor,fontFamily:t.fontFamily}),e.create("expiry",{containerId:"card-element-id-expiry",onlyIframe:!1,fontSize:t.fontSize,fontColor:t.fontColor,fontFamily:t.fontFamily}),e.create("cvc",{containerId:"card-element-id-cvc",onlyIframe:!1,fontSize:t.fontSize,fontColor:t.fontColor});var n=this,r={},i=n.settings.submitButton||document.getElementById("submit-button");i.setAttribute("disabled",!0);return e.addEventListener("change",function(e){e.success&&(r[e.type]=!0,n.errorHandler.hide()),e.error&&(r[e.type]=!1,n.errorHandler.show(e.error)),r.number&&r.expiry&&r.cvc?i.removeAttribute("disabled"):i.setAttribute("disabled",!0)}),e}},{key:"createInvoice",value:function(){return this.unzerInstance.Invoice()}},{key:"createInvoiceGuaranteed",value:function(){return this.customerResource=this.createCustomer(),this.unzerInstance.InvoiceSecured()}},{key:"createInvoiceFactoring",value:function(){return this.customerResource=this.createCustomer(),this.unzerInstance.InvoiceSecured()}},{key:"createSepa",value:function(){var e=this,t=this.unzerInstance.SepaDirectDebit();t.create("sepa-direct-debit",{containerId:"sepa-IBAN"});var n=this.settings.submitButton||document.getElementById("submit-button");return n.setAttribute("disabled",!0),t.addEventListener("change",function(t){if(t.success)return n.removeAttribute("disabled"),void e.errorHandler.hide();n.setAttribute("disabled",!0)}),t}},{key:"createSepaGuaranteed",value:function(){var e=this,t=this.unzerInstance.SepaDirectDebitSecured();t.create("sepa-direct-debit-guaranteed",{containerId:"sepa-guaranteed-IBAN"});var n=this.settings.submitButton||document.getElementById("submit-button");return n.setAttribute("disabled",!0),t.addEventListener("change",function(t){if(t.success)return n.removeAttribute("disabled"),void e.errorHandler.hide();n.setAttribute("disabled",!0)}),this.customerResource=this.createCustomer(),t}},{key:"createPaypal",value:function(){var e=this.unzerInstance.Paypal();return e.create("email",{containerId:"paypal-element-email"}),e}},{key:"createSofort",value:function(){return this.unzerInstance.Sofort()}},{key:"createGiropay",value:function(){return this.unzerInstance.Giropay()}},{key:"createPrzelewy24",value:function(){return this.unzerInstance.Przelewy24()}},{key:"createIdeal",value:function(){var e=this,t=this.unzerInstance.Ideal();t.create("ideal",{containerId:"ideal-element"});var n=this.settings.submitButton||document.getElementById("submit-button");return n.setAttribute("disabled",!0),t.addEventListener("change",function(t){if(t.value)return n.removeAttribute("disabled"),void e.errorHandler.hide();n.setAttribute("disabled",!0)}),t}},{key:"createPrepayment",value:function(){return this.unzerInstance.Prepayment()}},{key:"createEPS",value:function(){var e=this.unzerInstance.EPS();return e.create("eps",{containerId:"eps-element"}),e}},{key:"createFlexiPayDirect",value:function(){return this.unzerInstance.FlexiPayDirect()}},{key:"createAlipay",value:function(){return this.unzerInstance.Alipay()}},{key:"createWeChatPay",value:function(){return this.unzerInstance.Wechatpay()}},{key:"createHirePurchase",value:function(){var e=this.unzerInstance.InstallmentSecured(),t=this;this.customerResource=this.createCustomer();var n=t.settings.submitButton||document.getElementById("submit-button");return n.setAttribute("style","display: none"),n.setAttribute("disabled",!0),e.create({containerId:"hire-purchase-element",amount:this.settings.amount||null,currency:this.settings.currency||null,effectiveInterest:this.settings.effectiveInterest||null,orderDate:this.settings.orderDate||null}).then(function(e){}).catch(function(e){var n="";console.error(e.message),e.error.details.forEach(function(e){console.error("API-Error: "+e.code),n+=e.customerMessage}),t.errorHandler.show(n)}),e.addEventListener("installmentSecuredEvent",function(e){if("validate"===e.action){if(e.success)return void n.removeAttribute("disabled");n.setAttribute("disabled",!0)}if("change-step"===e.action){if("plan-list"===e.currentSteep)return n.setAttribute("style","display: none"),void n.setAttribute("disabled",!0);n.setAttribute("style","display: inline-block")}}),e}}]),e}();n.default=u,(0,s.default)(u,"PAYMENT_TYPES",{ALIPAY:"Alipay",CARD:"Card",EPS:"EPS",FLEXIPAY_DIRECT:"FlexiPay Direct",HIRE_PURCHASE:"Hire Purchase",PAYPAL:"Paypal",INVOICE:"Invoice",INVOICE_FACTORING:"Invoice Factoring",INVOICE_GUARANTEED:"Invoice Guaranteed",SEPA:"SEPA",SEPA_GUARANTEED:"SEPA (guaranteed)",SOFORT:"SOFORT",GIROPAY:"Giropay",PRZELEWY24:"Przelewy24",IDEAL:"iDEAL",PREPAYMENT:"Prepayment",WECHAT_PAY:"WeChat Pay",PAYLATER_INVOICE:"Paylater Invoice",BANCONTACT:"Bancontact"})},{"../utils/errors":6,"@babel/runtime/helpers/classCallCheck":7,"@babel/runtime/helpers/createClass":8,"@babel/runtime/helpers/defineProperty":9,"@babel/runtime/helpers/interopRequireDefault":10}],4:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;n.default=function(e,t,n){var r=$(e);t.addEventListener("click",function(){n.trigger("submit")}),n.on("submit",function(e){return!!r.is(":visible")||(e.preventDefault(),r.modal("show"),!1)})}},{}],5:[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=r(e("@babel/runtime/helpers/classCallCheck")),a=r(e("@babel/runtime/helpers/createClass")),s=function(){function e(t){(0,i.default)(this,e),this.$container=t,this.$log=null,window.UNZER_DEBUG&&this.createLogTemplate()}return(0,a.default)(e,[{key:"log",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};window.UNZER_DEBUG&&(this.$log||this.createLogTemplate(),this.$log.append("<li><strong>"+e+"</strong><pre>"+JSON.stringify(t,null,"  ")+"</pre></li>"))}},{key:"createLogTemplate",value:function(){this.$container.append($('<div class="debug-log card card-body bg-light"><ul class="list-unstyled"></ul></div>')),this.$log=this.$container.find(".debug-log > ul")}}]),e}();n.default=s},{"@babel/runtime/helpers/classCallCheck":7,"@babel/runtime/helpers/createClass":8,"@babel/runtime/helpers/interopRequireDefault":10}],6:[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=r(e("@babel/runtime/helpers/classCallCheck")),a=r(e("@babel/runtime/helpers/createClass")),s=function(){function e(t,n){(0,i.default)(this,e),this.$wrapper=t||$("#error-container"),this.$holder=n||this.$wrapper.find(".alert")}return(0,a.default)(e,[{key:"show",value:function(e){this.$wrapper.show(),this.$holder.html(e)}},{key:"hide",value:function(){this.$wrapper.hide(),this.$holder.html()}}]),e}();n.default=s},{"@babel/runtime/helpers/classCallCheck":7,"@babel/runtime/helpers/createClass":8,"@babel/runtime/helpers/interopRequireDefault":10}],7:[function(e,t,n){t.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},t.exports.__esModule=!0,t.exports.default=t.exports},{}],8:[function(e,t,n){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}t.exports=function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e},t.exports.__esModule=!0,t.exports.default=t.exports},{}],9:[function(e,t,n){t.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},t.exports.__esModule=!0,t.exports.default=t.exports},{}],10:[function(e,t,n){t.exports=function(e){return e&&e.__esModule?e:{default:e}},t.exports.__esModule=!0,t.exports.default=t.exports},{}]},{},[1]);
//# sourceMappingURL=unzer.min.js.map